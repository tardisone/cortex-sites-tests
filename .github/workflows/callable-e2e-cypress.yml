name: E2E Cypress Tests

on:
  workflow_call:
    inputs:
      app:
        description: 'Application under test: careesma, engineerjobs, wowjobs, gigajob, workopolis'
        required: true
        default: 'careesma'

jobs:
  test-workflow:
    runs-on: windows-latest
    steps:
      - name: checkout
        uses: actions/checkout@v3
      - name: Cypress tests
        uses: cypress-io/github-action@v3
        with:
          env: scope=smoke,stage=qa,executionPlatforms=["desktop","mobile"],app=${{ github.event.inputs.app }}
          spec: cypress/e2e/clientsites/Results.js
          browser: chrome
          record: true
        env:
          CORTEX_GITHUB_TOKEN_NPM: ${{ secrets.PUBLISH_TOKEN }}
          NODE_AUTH_TOKEN: ${{ secrets.PUBLISH_TOKEN }}
          PUBLISH_TOKEN_NPM: ${{ secrets.PUBLISH_TOKEN }}
          CYPRESS_RECORD_KEY: ${{ secrets.CYPRESSDASHBOARDFORCLIENTSITES }}
